{"remainingRequest":"/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/node_modules/babel-loader/lib/index.js!/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/src/components/SBDflowchart/renderMessage.js","dependencies":[{"path":"/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/src/components/SBDflowchart/renderMessage.js","mtime":1655113451069},{"path":"/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/babel.config.js","mtime":1654095143863},{"path":"/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/node_modules/cache-loader/dist/cjs.js","mtime":1655376985815},{"path":"/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/node_modules/babel-loader/lib/index.js","mtime":1655376985883}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport * as d3 from 'd3';\nimport { roundTo20 } from \"../../utils/math\";\n\nfunction wrapAction(text, initWidth, initX, initY) {\n  var width = initWidth;\n  text.each(function () {\n    var text = d3.select(this),\n        words = text.text().split(/(?!$)/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1,\n        // ems\n    y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")),\n        tspan = text.text(null).append(\"tspan\").attr(\"x\", initX).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n\n    while (word = words.pop()) {\n      line.push(word);\n      tspan.text(line.join(\"\"));\n\n      if (tspan.node().getComputedTextLength() > width || word === \"-\") {\n        line.pop();\n        tspan.text(line.join(\"\"));\n        line = [word];\n        tspan = text.append(\"tspan\").attr(\"x\", initX).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n      }\n    }\n  });\n}\n\nfunction wrap(text, initWidth, initX, initY, messages) {\n  var width = initWidth - 30;\n  text.each(function () {\n    var text = d3.select(this),\n        word,\n        words,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1,\n        // ems\n    y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")),\n        tspan = text.text(null).append(\"tspan\").attr(\"x\", initX - 40).attr(\"y\", y).attr(\"dy\", dy + \"em\"); //console.log(messages)\n\n    messages.forEach(function (message, index) {\n      String.prototype.insert = function (index, string) {\n        if (index > 0) {\n          return this.substring(0, index) + string + this.substr(index);\n        }\n\n        return string + this;\n      };\n\n      words = message.split(/\\s+/).reverse();\n      var wordLength = words.length;\n\n      while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(\" \")); //console.log(words.length)\n\n        if (tspan.node().getComputedTextLength() > width || words.length === wordLength - 1 && index != 0) {\n          //alert(\"Test\")\n          line.pop();\n          tspan.text(line.join(\" \"));\n          line = [word];\n          tspan = text.append(\"tspan\").attr(\"x\", initX - 40).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n        }\n      }\n    });\n  });\n}\n\nfunction renderMessage(g, node, isSelected) {\n  if (node.messages.length === 0) {\n    return;\n  }\n\n  node.width = node.width || 100;\n  node.height = node.height || 60;\n  var borderColor = isSelected ? '#666666' : '#bbbbbb';\n\n  if (node.type === 'send' || node.type === \"receive\" || node.type === \"action\") {\n    var boxWidth = 180;\n    /*g.append('path').\n      attr(\"id\", \"test\").\n      attr('stroke', \"#a3a3a3\").\n      attr('stroke-width', 1).\n      attr('fill', 'none').\n      attr('d', `M ${node.x} ${node.y} L ${node.x-(node.width/2)} ${node.y-(node.height/2)}`)*/\n\n    var rect = g.append('rect').attr('x', node.x - node.width / 2).attr('y', node.y).attr('stroke', borderColor).attr('class', 'title').style('fill', '#f1f3f4').style('stroke-width', '1px').style('width', boxWidth + 'px').attr('height', 20 + 'px');\n  }\n\n  if (node.type === \"action\") {\n    var text = node.messages;\n    var bodyTextY;\n    bodyTextY = node.y + roundTo20(node.height) / 5;\n    var txt = g.append('text').attr('x', node.x + 10).attr('y', bodyTextY).attr('class', 'unselectable').attr('text-anchor', 'middle').text(text).attr('dy', '.71em').call(wrapAction, node.width + 60, node.x + 40, node.y);\n    var height = txt.node().getBBox().height + 20; //<-- get our height plus a margin\n\n    rect.attr('height', height + 'px'); //<-- change our rect\n  } else {\n    var _txt = g.append('text').attr('x', node.x - node.width / 2).attr('y', node.y + 10).text(node.text).attr('class', 'unselectable').attr('dy', '.71em').style('fill', 'black').call(wrap, boxWidth, node.x, node.y, node.messages);\n\n    var _height = _txt.node().getBBox().height + 10; //<-- get our height plus a margin\n\n\n    rect.attr('height', _height + 'px'); //<-- change our rect\n  }\n}\n\nexport default renderMessage;",{"version":3,"names":["d3","roundTo20","wrapAction","text","initWidth","initX","initY","width","each","select","words","split","reverse","word","line","lineNumber","lineHeight","y","attr","dy","parseFloat","tspan","append","pop","push","join","node","getComputedTextLength","wrap","messages","forEach","message","index","String","prototype","insert","string","substring","substr","wordLength","length","renderMessage","g","isSelected","height","borderColor","type","boxWidth","rect","x","style","bodyTextY","txt","call","getBBox"],"sources":["/Users/leonhanschmann/Python_projects/PASS-web-app/PASS/src/components/SBDflowchart/renderMessage.js"],"sourcesContent":["import * as d3 from 'd3';\nimport {roundTo20} from '../../utils/math';\n\n\n\n\n\n\nfunction wrapAction(text, initWidth, initX, initY) {\n  let width = initWidth\n  text.each(function() {\n    var text = d3.select(this),\n        words = text.text().split(/(?!$)/u).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")),\n        tspan = text.text(null).append(\"tspan\").attr(\"x\", initX).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n    while (word = words.pop()) {\n      line.push(word);\n      tspan.text(line.join(\"\"));\n      if (tspan.node().getComputedTextLength() > width || word === \"-\") {\n        line.pop();\n        tspan.text(line.join(\"\"));\n        line = [word];\n        tspan = text.append(\"tspan\").attr(\"x\", initX).attr(\"y\",  y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n      }\n    }\n  });\n}\n\n\nfunction wrap(text, initWidth, initX, initY, messages) {\n  let width = initWidth-30\n  text.each(function() {\n    var text = d3.select(this),\n        word,\n        words,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")),\n        tspan = text.text(null).append(\"tspan\").attr(\"x\", initX-40).attr(\"y\", y).attr(\"dy\", dy + \"em\")\n      //console.log(messages)\n\n    messages.forEach(function(message, index) {\n      String.prototype.insert = function(index, string) {\n        if (index > 0) {\n          return this.substring(0, index) + string + this.substr(index);\n        }\n        return string + this;\n      };\n      words = message.split(/\\s+/).reverse();\n      let wordLength = words.length\n      while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(\" \"));\n        //console.log(words.length)\n        if (tspan.node().getComputedTextLength() > width || (words.length === (wordLength-1) && index != 0)) {\n          //alert(\"Test\")\n          line.pop();\n          tspan.text(line.join(\" \"));\n          line = [word];\n          tspan = text.append(\"tspan\").attr(\"x\", initX-40).attr(\"y\",  y).attr(\"dy\", ++lineNumber * lineHeight + dy+ \"em\").text(word);\n\n        }\n      }\n      })  \n\n  });\n}\nfunction renderMessage(g, node, isSelected) {\n  if(node.messages.length === 0){return;}\n    node.width = node.width || 100;\n    node.height = node.height || 60;\n    let borderColor = isSelected ? '#666666' : '#bbbbbb';\n    if (node.type === 'send' || node.type === \"receive\" || node.type === \"action\") {\n      var boxWidth = 180;\n      /*g.append('path').\n        attr(\"id\", \"test\").\n        attr('stroke', \"#a3a3a3\").\n        attr('stroke-width', 1).\n        attr('fill', 'none').\n        attr('d', `M ${node.x} ${node.y} L ${node.x-(node.width/2)} ${node.y-(node.height/2)}`)*/\n      var rect = g.append('rect').\n      attr('x', node.x-(node.width/2)).\n      attr('y', node.y).\n      attr('stroke', borderColor).\n      attr('class', 'title').\n      style('fill', '#f1f3f4').\n      style('stroke-width', '1px').\n      style('width', boxWidth + 'px')\n      .attr('height', 20 + 'px');\n    }\n\n    if(node.type === \"action\"){\n      let text = node.messages\n      let bodyTextY; \n        bodyTextY = node.y + roundTo20(node.height)/5;\n      \n      let txt = g.append('text').\n          attr('x', (node.x + 10) ).\n          attr('y', bodyTextY ).\n          attr('class', 'unselectable').\n          attr('text-anchor', 'middle').\n          text(text)\n          .attr('dy', '.71em')\n          .call(wrapAction, node.width + 60, node.x  +40, node.y);\n\n\n      let height = txt.node().getBBox().height + 20; //<-- get our height plus a margin\n      rect.attr('height', height + 'px'); //<-- change our rect\n    } else{\n      let txt = g.append('text').\n      attr('x', (node.x-(node.width/2))).\n      attr('y', node.y+10)\n      .text(node.text).\n      attr('class', 'unselectable')\n      .attr('dy', '.71em')\n      .style('fill', 'black')\n      .call(wrap, boxWidth, node.x, node.y, node.messages);\n\n      let height = txt.node().getBBox().height + 10; //<-- get our height plus a margin\n      rect.attr('height', height + 'px'); //<-- change our rect\n    }\n     \n    \n}\nexport default renderMessage;\n\n\n\n"],"mappings":"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"}]}